services:
  - type: web
    name: ranquiz-backend
    env: go
    buildCommand: |
      apt-get update && apt-get install -y python3 python3-pip && \
      python3 --version && pip3 --version && \
      pip3 install --upgrade pip && \
      pip3 install --no-cache-dir --upgrade --force-reinstall -r requirements.txt && \
      python3 -m pip show gumloop && \
      chmod +x ranquiz-backend && \
      go mod tidy && \
      GOOS=linux GOARCH=amd64 go build -o ranquiz-backend main.go
    startCommand: ./ranquiz-backend
    ports:
      - 8080
    envVars:
      - key: GUMELOOP_API_KEY
        sync: false
      - key: GUMELOOP_USER_ID
        sync: false
      - key: GUMELOOP_FLOW_ID
        sync: false